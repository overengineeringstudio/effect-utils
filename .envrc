#!/usr/bin/env bash

if command -v nix-shell &> /dev/null
then
  eval "$(devenv direnvrc)"
  use devenv
fi

export WORKSPACE_ROOT=$(pwd)

# Runtime CLI stamp for local builds (rev+YYYY-MM-DD-HHMMSS[-dirty]).
source "$WORKSPACE_ROOT/context/monorepo-compose/nix-cli-build-stamp.sh"
export NIX_CLI_BUILD_STAMP="$(nix_cli_build_stamp "$WORKSPACE_ROOT")"

if test -f ./.envrc.local; then
  source_env ./.envrc.local
fi
